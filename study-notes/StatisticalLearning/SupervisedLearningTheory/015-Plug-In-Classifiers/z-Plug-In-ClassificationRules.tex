
          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\section{Plug-in classification rules}
\setcounter{theorem}{0}
\setcounter{equation}{0}

%\cite{vanDerVaart1996}
%\cite{Kosorok2008}

%\renewcommand{\theenumi}{\alph{enumi}}
%\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}
\renewcommand{\theenumi}{\roman{enumi}}
\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\begin{definition}[Plug-in classification rules]
\mbox{}\vskip 0.1cm
\noindent
Suppose
\;$\left\{\;
\eta_{n} :
(\Re^{d},\mathcal{O}(\Re^{d})) \times \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}
\longrightarrow
[0,1]
\,\;\right\}_{n \in \N}$\;
is a sequence of Borel measurable $[0,1]$-functions.
Its \,\underline{{\color{white}.}\textbf{plug-in classification rule}}
\begin{equation*}
\left\{\;
\kappa_{\eta_{n}} : 
(\Re^{d},\mathcal{O}(\Re^{d})) \times \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}
\longrightarrow
\{0,1\}
\,\;\right\}_{n\in\N}
\end{equation*}
is defined as follows:
\begin{equation*}
\kappa_{\eta_{n}}(x,d_{n})
\;\; := \;\;
	\left\{\begin{array}{cl}
	0, & \textnormal{if $\eta_{n}(x,d_{n}) \leq 1/2$}
	\\
	\overset{{\color{white}-}}{1}, & \textnormal{if $\eta_{n}(x,d_{n}) > 1/2$}
	\end{array}\right.
\end{equation*}
\end{definition}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\vskip 0.5cm
\begin{theorem}[Corollaries 6.1 and 6.2, p.93, \cite{Devroye1996}]
\mbox{}\vskip 0.1cm
\noindent
Suppose:
\begin{itemize}
\item
	$d \in \N$.
	$\mathcal{O}(\Re^{d})$ denotes the Borel $\sigma$-algebra of \,$\Re^{d}$.
\item
	$\left\{\;
	\eta_{n} :
	(\Re^{d},\mathcal{O}(\Re^{d})) \times \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}
	\longrightarrow
	[0,1]
	\,\;\right\}_{n \in \N}$\;
	is a sequence of Borel measurable $[0,1]$-functions, and
	\begin{equation*}
	\left\{\;
	\kappa_{\eta_{n}} : 
	(\Re^{d},\mathcal{O}(\Re^{d})) \times \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}
	\longrightarrow
	\{0,1\}
	\,\;\right\}_{n\in\N}
	\end{equation*}
	is its plug-in classification rule.
\item
	$(\Omega,\mathcal{A},\mu)$ is a probability space.
	$X : (\Omega,\mathcal{A},\mu) \longrightarrow (\Re^{d},\mathcal{O}(\Re^{d}))$ and\,
	$Y : (\Omega,\mathcal{A},\mu) \longrightarrow \{0,1\}$
	are random variables.
\end{itemize}
Notations:
\begin{itemize}
\item
	$\eta_{\,Y \vert X } : \Re^{d} \longrightarrow [0,1]$ is the a posteriori probability $Y$ given $X$, i.e.
	\begin{equation*}
	\eta_{\,Y \vert X}(x) \;\; := \;\; P\!\left(\,\left. \overset{{\color{white}.}}{Y} = 1 \;\right\vert X = x \,\right)
	\end{equation*}
\item
	$\kappa^{*}_{\,Y \vert X} : \Re^{d} \longrightarrow \{0,1\}$ is the Bayes $(Y \vert X)$-classifier, i.e.
	\begin{equation*}
	\kappa^{*}_{\,Y \vert X} : \Re^{d} \longrightarrow \{0,1\} : x \longmapsto
		\left\{\begin{array}{cl}
			0, & \textnormal{if \,$P(\,Y=1 \,\vert X = x) \leq 1/2$}
			\\
			\overset{{\color{white}-}}{1}, & \textnormal{if \,$P(\,Y=1 \,\vert X = x) > 1/2$}
		\end{array}\right.
	\end{equation*}
\item
	$L^{*}_{\,Y \vert X}$ is the Bayes $(Y \vert X)$-risk,
	i.e. the probability of error of the Bayes $(Y \vert X)$-classifier;
	equivalently,
	\begin{equation*}
	L^{*}_{\,Y \vert X} \;\; := \;\; P\!\left(\, \kappa^{*}_{\,Y \vert X} \circ X \neq Y \,\right)
	\end{equation*}	
\item
	$\left\{\;
		(X_{i},Y_{i}) : (\Omega,\mathcal{A},\mu)
			\overset{{\color{white}-}}{\longrightarrow}
			(\Re^{d},\mathcal{O}(\Re^{d})) \times \{0,1\}
	\;\right\}_{i\in\N}$\;
	is a sequence of independent and identically distributed copies of
	$(X,Y) : (\Omega,\mathcal{A},\mu) \longrightarrow (\Re^{d},\mathcal{O}(\Re^{d})) \times \{0,1\}$.
\item
	For each $n \in \N$, we write
	$D^{(n)}_{X,Y} := (X_{1},Y_{1},\ldots,X_{n},Y_{n}) :
		(\Omega,\mathcal{A},\mu)
		\longrightarrow
		\left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}$.
\item
	$\left\{\,L^{(\kappa_{\eta_{n}})}_{\,Y \vert X}\,\right\}_{n\in\N}$\,
	is the \,$(Y \vert X)$-risk\, of the classification rule $\{\,\kappa_{\eta_{n}}\,\}_{n\in\N}$, i.e.
	\begin{equation*}
	L^{(\kappa_{\eta_{n}})}_{\,Y \vert X} :
		\left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n} \longrightarrow\; [\,0,1\,]
	\end{equation*}
	is defined by
	\begin{equation*}
	L^{(\kappa_{\eta_{n}})}_{\,Y \vert X}(\,d_{n}\,)
	\; := \;
		P\!\left(\, \kappa_{\eta_{n}}(X,d_{n}) \overset{{\color{white}.}}{\neq} Y \,\right)
	\; = \;
		\mu\!\left(\,\left\{\,
			\left.\omega\overset{{\color{white}.}}{\in}\Omega\;\,\right\vert\,\kappa_{\eta_{n}}(X(\omega),d_{n}) \neq Y(\omega)
			\,\right\}\,\right)
	\end{equation*}
\end{itemize}
Then, the following statements are true:
\begin{enumerate}
\item
	For each
	\;$d_{n} \in \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}$,
	\begin{eqnarray*}
	L^{(\kappa_{\eta_{n}})}_{\,Y \vert X}(\,d_{n}\,) \, - \, L^{*}_{\,Y \vert X}
	& = &
		P\!\left(\;\kappa_{\eta_{n}}(X,d_{n}) \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	\\
	& \leq &
		2 \cdot E\!\left[\;
			\left\vert\;\, \eta_{n}(X,d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X} \circ X \;\,\right\vert
			\;\right]
	\\
	& = &
		2 \cdot \int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert
			\;\d\mu(\omega)
	\end{eqnarray*}
\item
	For each
	\;$d_{n} \in \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}$,
	\begin{eqnarray*}
	L^{(\kappa_{\eta_{n}})}_{\,Y \vert X}(\,d_{n}\,) \, - \, L^{*}_{\,Y \vert X}
	& = &
		P\!\left(\;\kappa_{\eta_{n}}(X,d_{n}) \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	\\
	& \leq &
		2 \;\cdot\,
		\sqrt{\;\int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert^{2}
			\;\d\mu(\omega)
			\;}
	\end{eqnarray*}
\item
	The plug-in classification rule \,$\left\{\;\kappa_{\eta_{n}}\;\right\}_{n\in\N}$\,
	is weakly $(Y \vert X)$-consistent if
	\begin{equation*}
		\underset{n\rightarrow\infty}{\lim}\;
		\int_{\Omega}\;\left(\;
		\int_{\Omega}\,\;
			\left\vert\;\,
			\eta_{n}\!\left(X(\omega),D^{(n)}_{X,Y}(\zeta)\right) \,\overset{{\color{white}.}}{-}\; \eta_{\,Y\vert X}(X(\omega))
			\;\right\vert^{2}
		\,\d\mu(\omega)
		\;\right)\;\d\mu(\zeta)
		\;\; = \;\;
		0
	\end{equation*}
\end{enumerate}
\end{theorem}
\proof
\begin{enumerate}
\item
	Immediate by applying Theorem \ref{BoundOfProbabilityOfErrorsPlugInClassifier}(ii) for each
	$d_{n} \in \left(\;(\Re^{d},\mathcal{O}(\Re^{d})) \overset{{\color{white}.}}{\times} \{0,1\} \;\right)^{n}$.
\item
	\begin{eqnarray*}
	L^{(\kappa_{\eta_{n}})}_{\,Y \vert X}(\,d_{n}\,) \, - \, L^{*}_{\,Y \vert X}
	& \leq &
		2 \cdot \int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert
			\;\d\mu(\omega)\,,
		\quad
		\textnormal{by (i)}
	\\
	& = &
		2 \cdot \int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert
			\,\cdot\, 1
			\,\;\d\mu(\omega)
	\\
	& \leq &
		2 \cdot \sqrt{\;
			\int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert^{2}
			\,\d\mu(\omega)
			\;\cdot\;
			\int_{\Omega}\,\; 1^{2} \,\;\d\mu(\omega)
			\;}
	\\
	& = &
		2 \cdot \sqrt{\;
			\int_{\Omega}\,\;
			\left\vert\;\, \eta_{n}(X(\omega),d_{n}) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert^{2}
			\,\d\mu(\omega)
			\;}\,,
	\end{eqnarray*}
	where the second inequality follows by the Cauch-Schwarz inequality.
\item
	Immediate by (ii) and the definition of $(Y \vert X)$-consistence.
\end{enumerate}
This competes the proof of the Theorem.
\qed

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

%\renewcommand{\theenumi}{\alph{enumi}}
%\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}
\renewcommand{\theenumi}{\roman{enumi}}
\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%
