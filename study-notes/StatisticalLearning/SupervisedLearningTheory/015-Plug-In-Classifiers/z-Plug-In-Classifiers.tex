
          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\section{The plug-in classifier of a Borel measurable $[0,1]$-valued function}
\setcounter{theorem}{0}
\setcounter{equation}{0}

%\cite{vanDerVaart1996}
%\cite{Kosorok2008}

%\renewcommand{\theenumi}{\alph{enumi}}
%\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}
\renewcommand{\theenumi}{\roman{enumi}}
\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\begin{definition}[\textit{A Posteriori} Probability]
\mbox{}\vskip 0.1cm
\noindent
Suppose:
\begin{itemize}
\item
	$(\Omega,\mathcal{A},\mu)$ is a probability space.
	$X : (\Omega,\mathcal{A},\mu) \longrightarrow (\Re^{d},\mathcal{O}(\Re^{d}))$ and\,
	$Y : (\Omega,\mathcal{A},\mu) \longrightarrow \{0,1\}$
	are random variables.
\end{itemize}
Then, the \,\underline{\textbf{a posteriori probability}} of $Y$ given $X$ is, definition, the function
\begin{equation*}
\eta_{\,Y\vert X}
\;:\; \Re^{d} \longrightarrow [0,1]
\; :\; x \; \longmapsto \; P\!\left(\,\left. \overset{{\color{white}.}}{Y} = 1 \;\right\vert X = x\,\right)
\end{equation*}
\end{definition}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\vskip 0.5cm

\begin{definition}[Classifier]
\mbox{}\vskip 0.1cm
\noindent
A \,\underline{\textbf{classifier}}\, is a Borel measurable function
$g : \Re^{d} \longrightarrow \{0,1\}$,
where $d \in \N$ is a natural number.
\end{definition}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\vskip 0.5cm

\begin{definition}[Plug-in Classifier of a Borel measurable {$[0,1]$}-valued function] %$[0,1]$-valued function]
\mbox{}\vskip 0.1cm
\noindent
Suppose \,$\eta : \Re^{d} \longrightarrow [0,1]$\, is a Borel measurable function.
The \,\underline{{\color{white}.}\textbf{plug-in classifier}}\, $\kappa_{\eta}$ of $\eta$ is defined as follows:
\begin{equation*}
\kappa_{\eta}(x) \; : \; \Re^{d} \longrightarrow \{0,1\} \; : \; x \longmapsto
	\left\{\begin{array}{cl}
		0, & \textnormal{if \,$\eta(x) \leq 1/2$}
		\\
		\overset{{\color{white}-}}{1}, & \textnormal{if \,$\eta(x) > 1/2$}
	\end{array}\right.
\end{equation*}
\end{definition}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

\vskip 0.5cm
\begin{theorem}[Theorem 2.2, p.16, \cite{Devroye1996}]
\label{BoundOfProbabilityOfErrorsPlugInClassifier}
\mbox{}\vskip 0.1cm
\noindent
Suppose:
\begin{itemize}
\item
	$d \in \N$.
	$\mathcal{O}(\Re^{d})$ denotes the Borel $\sigma$-algebra of \,$\Re^{d}$.
\item
	$\eta : \Re^{d} \longrightarrow [0,1]$ is a Borel measurable function, and
	$\kappa_{\eta}$ its plug-in classifier.
\item
	$(\Omega,\mathcal{A},\mu)$ is a probability space.
	$X : (\Omega,\mathcal{A},\mu) \longrightarrow (\Re^{d},\mathcal{O}(\Re^{d}))$ and\,
	$Y : (\Omega,\mathcal{A},\mu) \longrightarrow \{0,1\}$
	are random variables.
\item
	$\eta_{\,Y \vert X } : \Re^{d} \longrightarrow [0,1]$ is the a posteriori probability $Y$ given $X$, i.e.
	\begin{equation*}
	\eta_{\,Y \vert X}(x) \;\; := \;\; P\!\left(\,\left. \overset{{\color{white}.}}{Y} = 1 \;\right\vert X = x \,\right)
	\end{equation*}
\item
	$\kappa^{*}_{\,Y \vert X} : \Re^{d} \longrightarrow \{0,1\}$ is the Bayes $(Y \vert X)$-classifier, i.e.
	\begin{equation*}
	\kappa^{*}_{\,Y \vert X} : \Re^{d} \longrightarrow \{0,1\} : x \longmapsto
		\left\{\begin{array}{cl}
			0, & \textnormal{if \,$P(\,Y=1 \,\vert X = x) \leq 1/2$}
			\\
			\overset{{\color{white}-}}{1}, & \textnormal{if \,$P(\,Y=1 \,\vert X = x) > 1/2$}
		\end{array}\right.
	\end{equation*}
\item
	$L^{*}_{\,Y \vert X}$ is the Bayes $(Y \vert X)$-risk,
	i.e. the probability of error of the Bayes $(Y \vert X)$-classifier;
	equivalently,
	\begin{equation*}
	L^{*}_{\,Y \vert X} \;\; := \;\; P\!\left(\, \kappa^{*}_{\,Y \vert X} \circ X \neq Y \,\right)
	\end{equation*}	
\end{itemize}
Then, we have
\begin{enumerate}
\item\label{boundOnProbabilityOrError}
	\begin{eqnarray*}
	P\!\left(\;\kappa_{\eta} \overset{{\color{white}.}}{\circ} X \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	& = &
		2 \cdot E\!\left[\;
			\left\vert\;\, \eta_{\,Y\vert X} \circ X \overset{{\color{white}.}}{-} 1/2 \;\,\right\vert
			\cdot
			I_{\left\{\,\kappa_{\eta} \circ X \,\neq\, \kappa^{*}_{Y \vert X} \circ X\,\right\}}
			\;\right]
	\\
	& = &
		2 \cdot \int_{\Omega}\,\;
			\left\vert\;\, \eta_{\,Y\vert X}(X(\omega)) \overset{{\color{white}.}}{-} 1/2 \;\,\right\vert
			\cdot
			I_{\left\{\,\kappa_{\eta}(X(\omega)) \,\neq\, \kappa^{*}_{Y \vert X}(X(\omega))\,\right\}}
			\,\;\d\mu(\omega)
	\end{eqnarray*}
\item
	\begin{eqnarray*}
	P\!\left(\;\kappa_{\eta} \overset{{\color{white}.}}{\circ} X \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	& \leq &
		2 \cdot E\!\left[\;
			\left\vert\;\, \eta \circ X \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X} \circ X \;\,\right\vert
			\;\right]
	\\
	& = &
		2 \cdot \int_{\Omega}\,\;
			\left\vert\;\, \eta(X(\omega)) \,\overset{{\color{white}.}}{-}\, \eta_{\,Y\vert X}(X(\omega)) \;\,\right\vert
			\;\d\mu(\omega)
	\end{eqnarray*}
\end{enumerate}
\end{theorem}
\proof
\begin{enumerate}
\item
	\begin{eqnarray*}
	P\!\left(\;\kappa_{\eta} \overset{{\color{white}.}}{\circ} X \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	&=&
		P\!\left(\;\kappa_{\eta} \overset{{\color{white}.}}{\circ} X \neq Y \;\right)
		\,-\,
		P\!\left(\;\kappa^{*}_{\,Y \vert X} \overset{{\color{white}.}}{\circ} X \neq Y \;\right)
	\\
	&=&
		E\!\left[\; I_{\left\{\, \kappa_{\eta} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}} \;\right]
		\,-\,
		E\!\left[\; I_{\left\{\, \kappa^{*}_{\,Y \vert X} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}} \;\right]
	\\
	&=&
		E\!\left[\,\;
			I_{\left\{\, \kappa_{\eta} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}}
			\,-\,
			I_{\left\{\, \kappa^{*}_{\,Y \vert X} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}}
		\,\;\right]
	\\
	&=&
		E\!\left[\,\;
		E\!\left[\,\;
			\left.
			I_{\left\{\, \kappa_{\eta} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}}
			\,-\,
			I_{\left\{\, \kappa^{*}_{\,Y \vert X} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\right\}}
			\,\;\right\vert\;
			X
		\,\;\right]
		\,\;\right]
	\\
	&=&
		E\!\left[\,\;
			P\!\left(\, \kappa_{\eta} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\vert\, X \,\right)
			\,-\,
			P\!\left(\, \kappa^{*}_{\,Y \vert X} \overset{{\color{white}.}}{\circ} X \,\neq\, Y \,\vert\, X \,\right)
		\,\;\right]
	\\
	&=&
		E\!\left[\,\;
			\left(\; 2 \cdot P\!\left(\left.Y=1\,\right\vert X \,\right) \,\overset{{\color{white}.}}{-}\, 1 \;\right)
			\cdot
			\left(\; I_{\{\kappa^{*}_{\,Y \vert X} \circ X \,=\, 1\}} \,\overset{{\color{white}.}}{-}\, I_{\{\kappa_{\eta} \circ X \,=\, 1\}} \;\right)
		\,\;\right],
		\;\;
		\textnormal{by Lemma \ref{lemma:conditionalProbabilityOfError}}
	\\
	&=&
		E\!\left[\,\;
			\left\vert\; 2 \cdot P\!\left(\left.Y=1\,\right\vert X \,\right) \,\overset{{\color{white}.}}{-}\, 1 \;\right\vert
			\cdot
			I_{\left\{\,\kappa^{*}_{\,Y \vert X} \circ X \,\neq\, \kappa_{\eta} \circ X\,\right\}}
		\,\;\right]
	\\
	&=&
		E\!\left[\,\;
			\left\vert\; 2 \cdot \eta_{\,Y \vert X} \circ X \,\overset{{\color{white}.}}{-}\, 1 \;\right\vert
			\cdot
			I_{\left\{\,\kappa^{*}_{\,Y \vert X} \circ X \,\neq\, \kappa_{\eta} \circ X\,\right\}}
		\,\;\right]
	\\
	&=&
		2 \cdot E\!\left[\,\;
			\left\vert\; \eta_{\,Y \vert X} \circ X \,\overset{{\color{white}.}}{-}\, 1/2 \;\right\vert
			\cdot
			I_{\left\{\,\kappa^{*}_{\,Y \vert X} \circ X \,\neq\, \kappa_{\eta} \circ X\,\right\}}
		\,\;\right]
	\end{eqnarray*}
\item
	\textbf{Claim 1:}\;\;
	For $x \in \Re^{d}$ with $\kappa^{*}_{\,Y \vert X}(x) \,\neq\, \kappa_{\eta}(x)$, we have
	\begin{equation*}
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, 1/2\;\right\vert
	\;\;\leq\;\;
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, \eta(x)\;\right\vert
	\end{equation*}
	Proof of Claim 1: First, observe that
	\,$\kappa^{*}_{\,Y \vert X}(x) \,\neq\, \kappa_{\eta}(x)$
	\,$\Longleftrightarrow$\,
	$(\kappa^{*}_{\,Y \vert X}(x),\kappa_{\eta}(x))$ $=$ $(0,1)$ or $(1,0)$.\,
	Now,
	\begin{equation*}
	(\kappa^{*}_{\,Y \vert X}(x),\kappa_{\eta}(x)) \,=\, (0,1)
	\;\;\Longleftrightarrow\;\;
	\eta_{\,Y \vert X}(x) \,\leq\, 1/2 \,<\, \eta(x)
	\;\;\Longrightarrow\;\;
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, 1/2\;\right\vert
	\;\;\leq\;\;
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, \eta(x)\;\right\vert
	\end{equation*}
	and
	\begin{equation*}
	(\kappa^{*}_{\,Y \vert X}(x),\kappa_{\eta}(x)) \,=\, (1,0)
	\;\;\Longleftrightarrow\;\;
	\eta(x) \,\leq\, 1/2 \,<\, \eta_{\,Y \vert X}(x)
	\;\;\Longrightarrow\;\;
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, 1/2\;\right\vert
	\;\;\leq\;\;
	\left\vert\;\eta_{\,Y \vert X}(x) \,\overset{{\color{white}.}}{-}\, \eta(x)\;\right\vert
	\end{equation*}
	This proves Claim 1.

	\vskip 0.5cm
	\noindent
	Hence,
	\begin{eqnarray*}
	P\!\left(\;\kappa_{\eta} \overset{{\color{white}.}}{\circ} X \neq Y \;\right) \,-\, L^{*}_{\,Y \vert X}
	&=&
		2 \cdot E\!\left[\,\;
			\left\vert\; \eta_{\,Y \vert X} \circ X \,\overset{{\color{white}.}}{-}\, 1/2 \;\right\vert
			\cdot
			I_{\left\{\,\kappa^{*}_{\,Y \vert X} \circ X \,\neq\, \kappa_{\eta} \circ X\,\right\}}
		\,\;\right],
		\;\;
		\textnormal{by \eqref{boundOnProbabilityOrError}}
	\\
	&\leq&
		2 \cdot E\!\left[\,\;
			\left\vert\; \eta \circ X \,\overset{{\color{white}.}}{-}\, \eta_{\,Y \vert X} \circ X \;\right\vert
		\,\;\right]
	\end{eqnarray*}
\end{enumerate}
This competes the proof of the Theorem.
\qed

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%

%\renewcommand{\theenumi}{\alph{enumi}}
%\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}
\renewcommand{\theenumi}{\roman{enumi}}
\renewcommand{\labelenumi}{\textnormal{(\theenumi)}$\;\;$}

          %%%%% ~~~~~~~~~~~~~~~~~~~~ %%%%%
